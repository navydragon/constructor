(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"0tM1":function(t,e,n){"use strict";n.r(e);var i={name:"dpps",metaInfo:{title:"Управление ДПП"},data:function(){return{fields:[{key:"name",label:"Наименование (тематика)",sortable:!0},{key:"type_name",label:"Тип",sortable:!0},{key:"participants",label:"Участников",sortable:!0},{key:"zuns",label:"ЗУНов",sortable:!0},{key:"modify",label:"Управление",sortable:!1}],items:[{}],info:"",isBusy:!0,new_dpp:{name:"",nameState:null,type:"",typeState:null,actors:[]},dpp_types:[]}},methods:{checkFormValidity:function(){var t=this.$refs.form.checkValidity();return this.new_dpp.nameState=t,this.new_dpp.typeState=t,t},resetModal:function(){this.new_dpp.name="",this.new_dpp.nameState=null,this.new_dpp.type="",this.new_dpp.typeState=null},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(){var t=this;this.checkFormValidity()&&(this.store_dpp(),this.$nextTick((function(){t.$bvModal.hide("create_dpp")})))},store_dpp:function(){var t=this;axios.post("/store_dpp",{name:this.new_dpp.name,type:this.new_dpp.type}).then((function(e){return t.items.push(e.data)})).finally((function(){return t.resetModal()}))},delete_dpp:function(t,e){var n=this;this.$bvModal.msgBoxConfirm("Действительно хотите удалить программу?").then((function(i){axios.post("/dpps/delete",{id:e}).then((function(){return n.items.splice(n.items.indexOf(t),1)}))})).catch((function(t){}))}},mounted:function(){var t=this;axios.get("/dpps").then((function(e){return t.items=e.data})).finally((function(){return t.isBusy=!1})),axios.get("/dpp_types").then((function(e){return t.dpp_types=e.data}))}},a=n("KHd+"),s=Object(a.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-card",{attrs:{title:"Управление ДПП"}},[n("b-card-text",[t._v("\n        Ниже отображается таблица всех созданных ДПП\n        ")]),t._v(" "),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.create_dpp",modifiers:{create_dpp:!0}}],attrs:{variant:"primary"}},[t._v("Создать ДПП")]),t._v(" "),n("hr"),t._v(" "),n("b-table",{attrs:{busy:t.isBusy,bordered:"",hover:"","table-variant":"light","head-variant":"light",items:t.items,fields:t.fields},scopedSlots:t._u([{key:"table-busy",fn:function(){return[n("div",{staticClass:"text-center text-info my-2"},[n("b-spinner",{staticClass:"align-middle"}),t._v(" "),n("strong",[t._v("Загрузка...")])],1)]},proxy:!0},{key:"cell(participants)",fn:function(e){return[t._v("\n                "+t._s(e.item.participants.length)+"\n            ")]}},{key:"cell(modify)",fn:function(e){return[t.isBusy?t._e():n("router-link",{attrs:{icon:"ion ion-md-eye",to:{name:"dpp_inspect",params:{dpp:e.item.id}},exact:!0}},[n("b-button",{attrs:{variant:"outline-info"}},[n("i",{staticClass:"ion ion-md-eye",staticStyle:{"font-size":"20px"}})])],1),t._v(" "),t.isBusy?t._e():n("router-link",{attrs:{icon:"ion ion-md-person",to:{name:"dpp_config",params:{dpp:e.item.id}},exact:!0}},[n("b-button",{attrs:{variant:"outline-primary"}},[n("i",{staticClass:"ion ion-md-construct",staticStyle:{"font-size":"20px"}})])],1),t._v(" "),n("b-button",{attrs:{variant:"outline-danger"},on:{click:function(n){return t.delete_dpp(e.item,e.item.id)}}},[n("i",{staticClass:"ion ion-md-close",staticStyle:{"font-size":"20px"}})])]}}])}),t._v("\n        "+t._s(this.info)+"\n    ")],1),t._v(" "),n("b-modal",{ref:"modal",attrs:{id:"create_dpp",title:"Создать ДПП","ok-title":"Создать","cancel-title":"Закрыть"},on:{ok:t.handleOk}},[n("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[n("b-form-group",{attrs:{state:t.new_dpp.nameState,label:"Наименование (тематика) ДПП","label-for":"name-input","invalid-feedback":"Необходимо ввести наименование","label-size":"lg"}},[n("b-form-input",{attrs:{id:"name-input",state:t.new_dpp.nameState,required:""},model:{value:t.new_dpp.name,callback:function(e){t.$set(t.new_dpp,"name",e)},expression:"new_dpp.name"}})],1),t._v(" "),n("b-form-group",{attrs:{state:t.new_dpp.typeState,label:"Тип ДПП","label-for":"type-input","invalid-feedback":"Необходимо выбрать тип ДПП","label-size":"lg"}},[n("b-form-select",{attrs:{id:"type-input",options:t.dpp_types,state:t.new_dpp.typeState,required:""},scopedSlots:t._u([{key:"first",fn:function(){},proxy:!0}]),model:{value:t.new_dpp.type,callback:function(e){t.$set(t.new_dpp,"type",e)},expression:"new_dpp.type"}})],1)],1)])],1)}),[],!1,null,null,null);e.default=s.exports}}]);