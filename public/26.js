(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"0tM1":function(t,e,i){"use strict";i.r(e);var n={name:"dpps",metaInfo:{title:"Управление ДПП"},data:function(){return{fields:[{key:"name",label:"Наименование (тематика)",sortable:!0},{key:"type_name",label:"Тип",sortable:!0},{key:"participants",label:"Участников",sortable:!0},{key:"zuns",label:"ЗУНов",sortable:!0},{key:"total_hours",label:"Часы по плану",sortable:!0},{key:"modify",label:"Управление",sortable:!1}],items:[{}],info:"",isBusy:!0,new_dpp:{name:"",nameState:null,type:"",typeState:null,total_hours:"",actors:[]},dpp_types:[]}},computed:{active_items:function(){return this.items.filter((function(t){return 0==t.is_archieved}))},archieved_items:function(){return this.items.filter((function(t){return 1==t.is_archieved}))}},methods:{checkFormValidity:function(){var t=this.$refs.form.checkValidity();return this.new_dpp.nameState=t,this.new_dpp.typeState=t,t},resetModal:function(){this.new_dpp.name="",this.new_dpp.nameState=null,this.new_dpp.type="",this.new_dpp.typeState=null},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(){var t=this;this.checkFormValidity()&&(this.store_dpp(),this.$nextTick((function(){t.$bvModal.hide("create_dpp")})))},store_dpp:function(){var t=this;axios.post("/store_dpp",{name:this.new_dpp.name,type:this.new_dpp.type}).then((function(e){return t.items.push(e.data)})).finally((function(){return t.resetModal()}))},delete_dpp:function(t,e){var i=this;this.$bvModal.msgBoxConfirm("Действительно хотите удалить программу?").then((function(n){!0===n&&axios.post("/dpps/delete",{id:e}).then((function(){return i.items.splice(i.items.indexOf(t),1)}))})).catch((function(t){}))},archive_dpp:function(t,e){var i=this;this.isBusy=!0,axios.post("/dpps/archive_dpp",{id:e}).then((function(e){var n=i.items.indexOf(t);i.$set(i.items[n],"is_archieved",1)})).finally((function(t){return i.isBusy=!1}))},unarchive_dpp:function(t,e){var i=this;this.isBusy=!0,axios.post("/dpps/unarchive_dpp",{id:e}).then((function(e){var n=i.items.indexOf(t);i.$set(i.items[n],"is_archieved",0)})).finally((function(t){return i.isBusy=!1}))}},mounted:function(){var t=this;axios.get("/dpps").then((function(e){return t.items=e.data})).finally((function(){return t.isBusy=!1})),axios.get("/dpp_types").then((function(e){return t.dpp_types=e.data}))}},a=i("KHd+"),s=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",{attrs:{title:"Управление ДПП"}},[i("b-card-text",[t._v("\n        Ниже отображается таблица всех созданных ДПП\n        ")]),t._v(" "),i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.create_dpp",modifiers:{create_dpp:!0}}],attrs:{variant:"primary"}},[t._v("Создать ДПП")]),t._v(" "),i("hr"),t._v(" "),i("b-card",{attrs:{"no-body":""}},[i("b-tabs",{attrs:{card:""}},[i("b-tab",{attrs:{title:"Активные программы",active:""}},[i("b-table",{attrs:{busy:t.isBusy,bordered:"",hover:"","table-variant":"light","head-variant":"light",items:t.active_items,fields:t.fields},scopedSlots:t._u([{key:"table-busy",fn:function(){return[i("div",{staticClass:"text-center text-info my-2"},[i("b-spinner",{staticClass:"align-middle"}),t._v(" "),i("strong",[t._v("Загрузка...")])],1)]},proxy:!0},{key:"cell(participants)",fn:function(e){return[t._v("\n                    "+t._s(e.item.participants.length)+"\n                ")]}},{key:"cell(modify)",fn:function(e){return[t.isBusy?t._e():i("router-link",{attrs:{icon:"ion ion-md-eye",to:{name:"dpp_inspect",params:{dpp:e.item.id}},exact:!0}},[i("b-button",{attrs:{variant:"outline-info"}},[i("i",{staticClass:"ion ion-md-eye",staticStyle:{"font-size":"20px"}})]),t._v(" "),t.isBusy?t._e():i("router-link",{attrs:{icon:"ion ion-md-person",to:{name:"dpp_overview",params:{dpp:e.item.id,role:1}},exact:!0}},[i("b-button",{attrs:{variant:"outline-primary"}},[i("i",{staticClass:"ion ion-md-create",staticStyle:{"font-size":"20px"}})])],1)],1),t._v(" "),t.isBusy?t._e():i("router-link",{attrs:{icon:"ion ion-md-person",to:{name:"dpp_config",params:{dpp:e.item.id}},exact:!0}},[i("b-button",{attrs:{variant:"outline-primary"}},[i("i",{staticClass:"ion ion-md-construct",staticStyle:{"font-size":"20px"}})])],1),t._v(" "),i("b-button",{attrs:{variant:"outline-primary"},on:{click:function(i){return t.archive_dpp(e.item,e.item.id)}}},[i("i",{staticClass:"ion ion-md-archive",staticStyle:{"font-size":"20px"}})])]}}])})],1),t._v(" "),i("b-tab",{attrs:{title:"Архив"}},[i("b-table",{attrs:{busy:t.isBusy,bordered:"",hover:"","table-variant":"light","head-variant":"light",items:t.archieved_items,fields:t.fields},scopedSlots:t._u([{key:"table-busy",fn:function(){return[i("div",{staticClass:"text-center text-info my-2"},[i("b-spinner",{staticClass:"align-middle"}),t._v(" "),i("strong",[t._v("Загрузка...")])],1)]},proxy:!0},{key:"cell(participants)",fn:function(e){return[t._v("\n                    "+t._s(e.item.participants.length)+"\n                ")]}},{key:"cell(modify)",fn:function(e){return[t.isBusy?t._e():i("router-link",{attrs:{icon:"ion ion-md-eye",to:{name:"dpp_inspect",params:{dpp:e.item.id}},exact:!0}},[i("b-button",{attrs:{variant:"outline-info"}},[i("i",{staticClass:"ion ion-md-eye",staticStyle:{"font-size":"20px"}})]),t._v(" "),t.isBusy?t._e():i("router-link",{attrs:{icon:"ion ion-md-person",to:{name:"dpp_overview",params:{dpp:e.item.id,role:1}},exact:!0}},[i("b-button",{attrs:{variant:"outline-primary"}},[i("i",{staticClass:"ion ion-md-create",staticStyle:{"font-size":"20px"}})])],1)],1),t._v(" "),t.isBusy?t._e():i("router-link",{attrs:{icon:"ion ion-md-person",to:{name:"dpp_config",params:{dpp:e.item.id}},exact:!0}},[i("b-button",{attrs:{variant:"outline-primary"}},[i("i",{staticClass:"ion ion-md-construct",staticStyle:{"font-size":"20px"}})])],1),t._v(" "),i("b-button",{attrs:{variant:"outline-primary"},on:{click:function(i){return t.unarchive_dpp(e.item,e.item.id)}}},[i("i",{staticClass:"ion ion-md-arrow-back",staticStyle:{"font-size":"20px"}})])]}}])})],1)],1)],1),t._v("\n       \n        "+t._s(this.info)+"\n    ")],1),t._v(" "),i("b-modal",{ref:"modal",attrs:{id:"create_dpp",title:"Создать ДПП","ok-title":"Создать","cancel-title":"Закрыть"},on:{ok:t.handleOk}},[i("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("b-form-group",{attrs:{state:t.new_dpp.nameState,label:"Наименование (тематика) ДПП","label-for":"name-input","invalid-feedback":"Необходимо ввести наименование","label-size":"lg"}},[i("b-form-input",{attrs:{id:"name-input",state:t.new_dpp.nameState,required:""},model:{value:t.new_dpp.name,callback:function(e){t.$set(t.new_dpp,"name",e)},expression:"new_dpp.name"}})],1),t._v(" "),i("b-form-group",{attrs:{label:"Часы по плану"}},[i("b-form-input",{attrs:{required:""},model:{value:t.new_dpp.total_hours,callback:function(e){t.$set(t.new_dpp,"total_hours",e)},expression:"new_dpp.total_hours"}})],1),t._v(" "),i("b-form-group",{attrs:{state:t.new_dpp.typeState,label:"Тип ДПП","label-for":"type-input","invalid-feedback":"Необходимо выбрать тип ДПП","label-size":"lg"}},[i("b-form-select",{attrs:{id:"type-input",options:t.dpp_types,state:t.new_dpp.typeState,required:""},scopedSlots:t._u([{key:"first",fn:function(){},proxy:!0}]),model:{value:t.new_dpp.type,callback:function(e){t.$set(t.new_dpp,"type",e)},expression:"new_dpp.type"}})],1)],1)])],1)}),[],!1,null,null,null);e.default=s.exports}}]);