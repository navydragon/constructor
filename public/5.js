(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{EnZQ:function(e,t,i){(e.exports=i("I1BE")(!1)).push([e.i,'[dir="rtl"] .tree {\n  text-align: right;\n}\n[dir="rtl"] .tree-icon.tree-checkbox,\n[dir="rtl"] .tree-icon.tree-themeicon {\n  -webkit-transform: scaleX(-1);\n          transform: scaleX(-1);\n}\n[dir="rtl"] .tree-default.tree-rtl .tree-node {\n  margin-right: 30px;\n}\n[dir="rtl"] .tree-default > .tree-container-ul > .tree-node {\n  margin-right: 0;\n}\n.tree-closed > .tree-children .tree-selected,\n.tree-closed:not(.tree-leaf) > .tree-children .tree-wholerow-clicked {\n  background: none !important;\n}\n',""])},FpiS:function(e,t,i){"use strict";var n=i("NGKf");i.n(n).a},NGKf:function(e,t,i){var n=i("EnZQ");"string"==typeof n&&(n=[[e.i,n,""]]);var l={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,l);n.locals&&(e.exports=n.locals)},rmMb:function(e,t,i){"use strict";i.r(t);var n=i("08io"),l=i.n(n),s=i("4NZ4"),a=i.n(s),o=(i("9lYJ"),{name:"new-skill",metaInfo:{title:"Добавить новый навык"},components:{VJstree:l.a,OrganizationChart:a.a},data:function(){return{new_skil:{text:"",show_edit:!1,show_errors:!1,editingItem:{},editingNode:null,skilData:[{text:"Новый навык",opened:!0,type:"skil",color:"btn-secondary",icon:"ion ion-ios-radio-button-on text-secondary",valid:!1,keyword:"Владеть навыком",what:"",with:"",where:"",children:[]}],errors:[]}}},computed:{ei_fulltext:function(){return this.combine_text(this.new_skil.editingItem)},ei_add_disable:function(){if("abil"==this.new_skil.editingItem.type){if(this.new_skil.editingItem.children.length<10)return!1}else if(this.new_skil.editingItem.children.length<3)return!1;return!0}},methods:{handle_ok_skil:function(e){var t=this;e.preventDefault(),this.new_skil.errors=[],this.check_skil(this.new_skil.skilData)>0?this.new_skil.show_errors=!0:(this.new_skil.show_errors=!1,this.$emit("add_skil",this.new_skil.skilData[0]),this.new_skil.show_edit=!1,this.new_skil.editingItem={},this.new_skil.editingNode=null,this.new_skil.skilData=[{id:this.generate_id(),text:"Новый навык",opened:!0,type:"skil",color:"btn-secondary",icon:"ion ion-ios-radio-button-on text-secondary",valid:!1,children:[],keyword:"Владеть навыком",what:"",with:"",where:""}],this.$nextTick((function(){t.$bvModal.hide("modal-addskil")})))},kek:function(e){console.log(e),this.new_skil.editingNode=e,this.new_skil.editingItem=e,console.log(this.new_skil.editingItem),this.new_skil.show_edit=!0},nc_onSubmit:function(e){var t,i,n,l,s,a,o,r;switch(e.preventDefault(),this.new_skil.editingItem.text=this.combine_text(this.new_skil.editingItem),this.new_skil.editingItem.valid=!0,this.new_skil.editingItem.type){case"skil":t="abil",i="Умение",n="btn-success",l="ion ion-ios-radio-button-on text-success",s="Уметь",a="",o="",r="";break;case"abil":t="know",i="Знание",n="btn-warning",l="ion ion-ios-radio-button-on text-warning",s="Знать",a="",o="",r=""}if("know"!==this.new_skil.editingItem.type&&0===this.new_skil.editingItem.children.length)for(var d=1;d<=2;d++)this.new_skil.editingItem.children.push({id:this.generate_id(),text:i+" "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:t,title:i,color:n,icon:l,keyword:s,what:a,with:o,where:r,children:[]})},nc_onReset:function(e){e.preventDefault(),alert(JSON.stringify(this.form))},combine_text:function(e){return e.keyword+" "+e.what+" "+e.with+" "+e.where},generate_id:function(){return"f".concat((~~(1e8*Math.random())).toString(16))},nc_add_abil_to_skil:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Умение "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"abil",title:"Умение",color:"btn-success",icon:"ion ion-ios-radio-button-on text-success",keyword:"Уметь",what:"",with:"",where:"",children:[]})},nc_add_know_to_abil:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Знание "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"know",title:"Знание",color:"btn-warning",icon:"ion ion-ios-radio-button-on text-warning",keyword:"Знать",what:"",with:"",where:"",children:[]})},check_skil:function(e){for(var t=0,i=0;i<e.length;i++)!1===e[i].valid&&(t++,this.new_skil.errors.push("Не заполнен компонент «"+e[i].text+"»")),e[i].children.length>0&&(t+=this.check_skil(e[i].children));return t},delete_el:function(e,t){for(var i=0;i<e.length;i++){if(e[i].id==t.id)return e.splice(e.indexOf(t),1),this.new_skil.editingItem={},this.new_skil.show_edit=!1,!0;e[i].children.length>0&&this.delete_el(e[i].children,t)}},is_deletable:function(e,t,i){for(var n=0;n<e.children.length;n++)e.children[n].id==t.id&&e.children.length>2&&(i=!0),e.children[n].children.length>0&&(i=this.is_deletable(e.children[n],t,i));return i}}}),r=i("KHd+"),d=Object(r.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-addskil",modifiers:{"modal-addskil":!0}}],attrs:{variant:"secondary"}},[e._v("Добавить навык")]),e._v(" "),i("b-modal",{attrs:{"no-close-on-esc":"","no-close-on-backdrop":"","ok-only":"",id:"modal-addskil","ok-title":"Добавить навык","cancel-title":"Закрыть",size:"xl",title:"Создание нового навыка"},on:{ok:e.handle_ok_skil}},[e.new_skil.show_edit?e._e():i("b-alert",{attrs:{show:"",variant:"info"}},[e._v("Выберите компонент на диаграмме для редактирования")]),e._v(" "),e._l(this.new_skil.skilData,(function(t){return i("div",{key:t.id,staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("organization-chart",{attrs:{datasource:t,direction:"l2r"},on:{"node-click":e.kek},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.nodeData;return[i("span",{class:"btn btn-block "+n.color},[n.valid?e._e():i("b-badge",{attrs:{variant:"danger"}},[e._v("!")]),e._v(" "+e._s(n.text))],1)]}}],null,!0)})],1)])})),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[e.new_skil.show_edit?i("b-card",{staticClass:"mt-3",attrs:{header:"Редактирование компонента «"+e.new_skil.editingItem.text+"»","border-variant":"secondary"}},["skil"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Владеть навыком",value:"Владеть навыком"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Чем?"}},[i("b-input",{attrs:{required:"",placeholder:"Чем?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При помощи чего?"}},[i("b-input",{attrs:{required:"",placeholder:"При помощи чего?"},model:{value:e.new_skil.editingItem.with,callback:function(t){e.$set(e.new_skil.editingItem,"with",t)},expression:"new_skil.editingItem.with"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При каких условиях?"}},[i("b-input",{attrs:{required:"",placeholder:"При каких условиях?"},model:{value:e.new_skil.editingItem.where,callback:function(t){e.$set(e.new_skil.editingItem,"where",t)},expression:"new_skil.editingItem.where"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-form-row",[i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v(" \n              "),e.new_skil.editingItem.valid?i("b-button",{attrs:{disabled:e.ei_add_disable,variant:"success"},on:{click:e.nc_add_abil_to_skil}},[e._v("Добавить умение")]):e._e(),e._v("\n               \n              ")],1)],1):e._e(),e._v(" "),"abil"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Уметь",value:"Уметь"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Что?"}},[i("b-input",{attrs:{required:"",placeholder:"Что?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При помощи чего?"}},[i("b-input",{attrs:{required:"",placeholder:"При помощи чего?"},model:{value:e.new_skil.editingItem.with,callback:function(t){e.$set(e.new_skil.editingItem,"with",t)},expression:"new_skil.editingItem.with"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При каких условиях?"}},[i("b-input",{attrs:{required:"",placeholder:"При каких условиях?"},model:{value:e.new_skil.editingItem.where,callback:function(t){e.$set(e.new_skil.editingItem,"where",t)},expression:"new_skil.editingItem.where"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v(" "),e.new_skil.editingItem.valid?i("b-button",{attrs:{disabled:e.ei_add_disable,variant:"warning"},on:{click:e.nc_add_know_to_abil}},[e._v("Добавить знание")]):e._e(),e._v("\n               \n              "),i("b-button",{attrs:{disabled:!e.is_deletable(e.new_skil.skilData[0],e.new_skil.editingItem,!1),variant:"danger"},on:{click:function(t){return e.delete_el(e.new_skil.skilData[0].children,e.new_skil.editingItem)}}},[e._v("Удалить компонент")])],1):e._e(),e._v(" "),"know"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Знать",value:"Знать"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Что?"}},[i("b-input",{attrs:{required:"",placeholder:"Что?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название:"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v("\n               \n              "),i("b-button",{attrs:{disabled:!e.is_deletable(e.new_skil.skilData[0],e.new_skil.editingItem,!1),variant:"danger"},on:{click:function(t){return e.delete_el(e.new_skil.skilData[0].children,e.new_skil.editingItem)}}},[e._v("Удалить компонент")])],1):e._e()],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[this.new_skil.show_errors?i("b-alert",{attrs:{variant:"danger",show:""}},[i("strong",[e._v("Обнаружены ошибки!")]),e._v(" "),e._l(this.new_skil.errors,(function(t,n){return i("ul",{key:n},[i("li",[e._v(e._s(t))])])}))],2):e._e()],1)])],2)],1)}),[],!1,null,null,null).exports,c={name:"new-ability",metaInfo:{title:"Добавить новое умение"},components:{VJstree:l.a,OrganizationChart:a.a},data:function(){return{new_skil:{text:"",show_edit:!1,show_errors:!1,editingItem:{},editingNode:null,skilData:[{text:"Новое умение",opened:!0,type:"abil",color:"btn-success",icon:"ion ion-ios-radio-button-on text-success",valid:!1,keyword:"Уметь",what:"",with:"",where:"",children:[]}],errors:[]}}},computed:{ei_fulltext:function(){return this.combine_text(this.new_skil.editingItem)},ei_add_disable:function(){if("abil"==this.new_skil.editingItem.type){if(this.new_skil.editingItem.children.length<10)return!1}else if(this.new_skil.editingItem.children.length<3)return!1;return!0}},methods:{handle_ok_skil:function(e){var t=this;e.preventDefault(),this.new_skil.errors=[],this.check_skil(this.new_skil.skilData)>0?this.new_skil.show_errors=!0:(this.new_skil.show_errors=!1,this.$emit("add_abil",this.new_skil.skilData[0]),this.new_skil.show_edit=!1,this.new_skil.editingItem={},this.new_skil.editingNode=null,this.new_skil.skilData=[{id:this.generate_id(),text:"Новое умение",opened:!0,type:"abil",color:"btn-success",icon:"ion ion-ios-radio-button-on text-success",valid:!1,children:[],keyword:"Уметь",what:"",with:"",where:""}],this.$nextTick((function(){t.$bvModal.hide("modal-addabil")})))},kek:function(e){console.log(e),this.new_skil.editingNode=e,this.new_skil.editingItem=e,console.log(this.new_skil.editingItem),this.new_skil.show_edit=!0},nc_onSubmit:function(e){var t,i,n,l,s,a,o,r;switch(e.preventDefault(),this.new_skil.editingItem.text=this.combine_text(this.new_skil.editingItem),this.new_skil.editingItem.valid=!0,this.new_skil.editingItem.type){case"skil":t="abil",i="Умение",n="btn-success",l="ion ion-ios-radio-button-on text-success",s="Уметь",a="",o="",r="";break;case"abil":t="know",i="Знание",n="btn-warning",l="ion ion-ios-radio-button-on text-warning",s="Знать",a="",o="",r=""}if("know"!==this.new_skil.editingItem.type&&0===this.new_skil.editingItem.children.length)for(var d=1;d<=2;d++)this.new_skil.editingItem.children.push({id:this.generate_id(),text:i+" "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:t,title:i,color:n,icon:l,keyword:s,what:a,with:o,where:r,children:[]})},nc_onReset:function(e){e.preventDefault(),alert(JSON.stringify(this.form))},combine_text:function(e){return e.keyword+" "+e.what+" "+e.with+" "+e.where},generate_id:function(){return"f".concat((~~(1e8*Math.random())).toString(16))},nc_add_abil_to_skil:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Умение "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"abil",title:"Умение",color:"btn-success",icon:"ion ion-ios-radio-button-on text-success",keyword:"Уметь",what:"",with:"",where:"",children:[]})},nc_add_know_to_abil:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Знание "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"know",title:"Знание",color:"btn-warning",icon:"ion ion-ios-radio-button-on text-warning",keyword:"Знать",what:"",with:"",where:"",children:[]})},check_skil:function(e){for(var t=0,i=0;i<e.length;i++)!1===e[i].valid&&(t++,this.new_skil.errors.push("Не заполнен компонент «"+e[i].text+"»")),e[i].children.length>0&&(t+=this.check_skil(e[i].children));return t},delete_el:function(e,t){for(var i=0;i<e.length;i++){if(e[i].id==t.id)return e.splice(e.indexOf(t),1),this.new_skil.editingItem={},this.new_skil.show_edit=!1,!0;e[i].children.length>0&&this.delete_el(e[i].children,t)}},is_deletable:function(e,t,i){for(var n=0;n<e.children.length;n++)e.children[n].id==t.id&&e.children.length>2&&(i=!0),e.children[n].children.length>0&&(i=this.is_deletable(e.children[n],t,i));return i}}},_=Object(r.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-addabil",modifiers:{"modal-addabil":!0}}],attrs:{variant:"success"}},[e._v("Добавить умение")]),e._v(" "),i("b-modal",{attrs:{"no-close-on-esc":"","no-close-on-backdrop":"","ok-only":"",id:"modal-addabil","ok-title":"Добавить умение","cancel-title":"Закрыть",size:"xl",title:"Создание нового умения"},on:{ok:e.handle_ok_skil}},[e.new_skil.show_edit?e._e():i("b-alert",{attrs:{show:"",variant:"info"}},[e._v("Выберите компонент на диаграмме для редактирования")]),e._v(" "),e._l(this.new_skil.skilData,(function(t){return i("div",{key:t.id,staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("organization-chart",{attrs:{datasource:t,direction:"l2r"},on:{"node-click":e.kek},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.nodeData;return[i("span",{class:"btn btn-block "+n.color},[n.valid?e._e():i("b-badge",{attrs:{variant:"danger"}},[e._v("!")]),e._v(" "+e._s(n.text))],1)]}}],null,!0)})],1)])})),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[e.new_skil.show_edit?i("b-card",{staticClass:"mt-3",attrs:{header:"Редактирование компонента «"+e.new_skil.editingItem.text+"»","border-variant":"secondary"}},["abil"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Уметь",value:"Уметь"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Что?"}},[i("b-input",{attrs:{required:"",placeholder:"Что?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При помощи чего?"}},[i("b-input",{attrs:{required:"",placeholder:"При помощи чего?"},model:{value:e.new_skil.editingItem.with,callback:function(t){e.$set(e.new_skil.editingItem,"with",t)},expression:"new_skil.editingItem.with"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При каких условиях?"}},[i("b-input",{attrs:{required:"",placeholder:"При каких условиях?"},model:{value:e.new_skil.editingItem.where,callback:function(t){e.$set(e.new_skil.editingItem,"where",t)},expression:"new_skil.editingItem.where"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v(" "),e.new_skil.editingItem.valid?i("b-button",{attrs:{disabled:e.ei_add_disable,variant:"warning"},on:{click:e.nc_add_know_to_abil}},[e._v("Добавить знание")]):e._e(),e._v("\n               \n          ")],1):e._e(),e._v(" "),"know"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Знать",value:"Знать"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Что?"}},[i("b-input",{attrs:{required:"",placeholder:"Что?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название:"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v("\n               \n              "),i("b-button",{attrs:{disabled:!e.is_deletable(e.new_skil.skilData[0],e.new_skil.editingItem,!1),variant:"danger"},on:{click:function(t){return e.delete_el(e.new_skil.skilData[0].children,e.new_skil.editingItem)}}},[e._v("Удалить компонент")])],1):e._e()],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[this.new_skil.show_errors?i("b-alert",{attrs:{variant:"danger",show:""}},[i("strong",[e._v("Обнаружены ошибки!")]),e._v(" "),e._l(this.new_skil.errors,(function(t,n){return i("ul",{key:n},[i("li",[e._v(e._s(t))])])}))],2):e._e()],1)])],2)],1)}),[],!1,null,null,null).exports,h={name:"edit-item",metaInfo:{title:"Редактирование компонента"},components:{VJstree:l.a,OrganizationChart:a.a},props:{new_skil:Object},computed:{ei_fulltext:function(){return this.combine_text(this.new_skil.editingItem)},ei_add_disable:function(){if("abil"==this.new_skil.editingItem.type){if(this.new_skil.editingItem.children.length<10)return!1}else if(this.new_skil.editingItem.children.length<3)return!1;return!0}},methods:{handle_ok_skil:function(e){e.preventDefault(),this.new_skil.errors=[],this.check_skil(this.new_skil.skilData)>0?this.new_skil.show_errors=!0:(this.new_skil.show_errors=!1,this.$emit("update_item",this.new_skil.skilData[0]),this.new_skil.skilData=[],this.new_skil.show_edit=!1,this.new_skil.editingItem={},this.new_skil.editingNode=null)},kek:function(e){console.log(e),this.new_skil.editingNode=e,this.new_skil.editingItem=e,console.log(this.new_skil.editingItem),this.new_skil.show_edit=!0},nc_onSubmit:function(e){var t,i,n,l,s,a,o,r;switch(e.preventDefault(),this.new_skil.editingItem.text=this.combine_text(this.new_skil.editingItem),this.new_skil.editingItem.valid=!0,this.new_skil.editingItem.type){case"skil":t="abil",i="Умение",n="btn-success",l="ion ion-ios-radio-button-on text-success",s="Уметь",a="",o="",r="";break;case"abil":t="know",i="Знание",n="btn-warning",l="ion ion-ios-radio-button-on text-warning",s="Знать",a="",o="",r=""}if("know"!==this.new_skil.editingItem.type&&0===this.new_skil.editingItem.children.length)for(var d=1;d<=2;d++)this.new_skil.editingItem.children.push({id:this.generate_id(),text:i+" "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:t,title:i,color:n,icon:l,keyword:s,what:a,with:o,where:r,children:[]})},nc_onReset:function(e){e.preventDefault(),alert(JSON.stringify(this.form))},combine_text:function(e){return e.keyword+" "+e.what+" "+e.with+" "+e.where},generate_id:function(){return"f".concat((~~(1e8*Math.random())).toString(16))},nc_add_abil_to_skil:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Умение "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"abil",title:"Умение",color:"btn-success",icon:"ion ion-ios-radio-button-on text-success",keyword:"Уметь",what:"",with:"",where:"",children:[]})},nc_add_abil_to_comp:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Умение "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"abil",title:"Умение",color:"btn-success",icon:"ion ion-ios-radio-button-on text-success",keyword:"Уметь",what:"",with:"",where:"",children:[]})},nc_add_skil_to_comp:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Навык "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"skil",title:"Навык",color:"btn-secondary",icon:"ion ion-ios-radio-button-on text-secondary",keyword:"Владеть навыком",what:"",with:"",where:"",children:[]})},nc_add_know_to_abil:function(){this.new_skil.editingItem.children.push({id:this.generate_id(),text:"Знание "+(this.new_skil.editingItem.children.length+1),opened:!0,valid:!1,type:"know",title:"Знание",color:"btn-warning",icon:"ion ion-ios-radio-button-on text-warning",keyword:"Знать",what:"",with:"",where:"",children:[]})},check_skil:function(e){for(var t=0,i=0;i<e.length;i++)!1===e[i].valid&&(t++,this.new_skil.errors.push("Не заполнен компонент «"+e[i].text+"»")),e[i].children.length>0&&(t+=this.check_skil(e[i].children));return t},delete_el:function(e,t){for(var i=0;i<e.length;i++){if(e[i].id==t.id)return e.splice(e.indexOf(t),1),this.new_skil.editingItem={},this.new_skil.show_edit=!1,!0;e[i].children.length>0&&this.delete_el(e[i].children,t)}},is_deletable:function(e,t,i){for(var n=0;n<e.children.length;n++)e.children[n].id==t.id&&e.children.length>1&&(console.log("can_be_deleted"),i=!0),e.children[n].children.length>0&&(i=this.is_deletable(e.children[n],t,i));return i}}},w=Object(r.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{attrs:{"no-close-on-esc":"","no-close-on-backdrop":"","ok-only":"",id:"modal-edititem","ok-title":"Сохранить изменения","cancel-title":"Закрыть",size:"xl",title:"Редактирование компонента"},on:{ok:e.handle_ok_skil}},[e.new_skil.show_edit?e._e():i("b-alert",{attrs:{show:"",variant:"info"}},[e._v("Выберите компонент на диаграмме для редактирования")]),e._v(" "),e._l(this.new_skil.skilData,(function(t){return i("div",{key:t.id,staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("organization-chart",{attrs:{datasource:t,direction:"l2r"},on:{"node-click":e.kek},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.nodeData;return[i("span",{class:"btn btn-block "+n.color},[n.valid?e._e():i("b-badge",{attrs:{variant:"danger"}},[e._v("!")]),e._v(" "+e._s(n.text))],1)]}}],null,!0)})],1)])})),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[e.new_skil.show_edit?i("b-card",{staticClass:"mt-3",attrs:{header:"Редактирование компонента «"+e.new_skil.editingItem.text+"»","border-variant":"secondary"}},["comp"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Способен",value:"Способен"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"На что?"}},[i("b-input",{attrs:{required:"",placeholder:"На что?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При помощи чего?"}},[i("b-input",{attrs:{required:"",placeholder:"При помощи чего?"},model:{value:e.new_skil.editingItem.with,callback:function(t){e.$set(e.new_skil.editingItem,"with",t)},expression:"new_skil.editingItem.with"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При каких условиях?"}},[i("b-input",{attrs:{required:"",placeholder:"При каких условиях?"},model:{value:e.new_skil.editingItem.where,callback:function(t){e.$set(e.new_skil.editingItem,"where",t)},expression:"new_skil.editingItem.where"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-form-row",[i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v(" \n            "),e.new_skil.editingItem.valid?i("b-button",{attrs:{disabled:e.ei_add_disable,variant:"secondary"},on:{click:e.nc_add_skil_to_comp}},[e._v("Добавить навык")]):e._e(),e._v(" \n            "),e.new_skil.editingItem.valid?i("b-button",{attrs:{disabled:e.ei_add_disable,variant:"success"},on:{click:e.nc_add_abil_to_comp}},[e._v("Добавить умение")]):e._e(),e._v("\n             \n            ")],1)],1):e._e(),e._v(" "),"skil"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Владеть навыком",value:"Владеть навыком"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Чем?"}},[i("b-input",{attrs:{required:"",placeholder:"Чем?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При помощи чего?"}},[i("b-input",{attrs:{required:"",placeholder:"При помощи чего?"},model:{value:e.new_skil.editingItem.with,callback:function(t){e.$set(e.new_skil.editingItem,"with",t)},expression:"new_skil.editingItem.with"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При каких условиях?"}},[i("b-input",{attrs:{required:"",placeholder:"При каких условиях?"},model:{value:e.new_skil.editingItem.where,callback:function(t){e.$set(e.new_skil.editingItem,"where",t)},expression:"new_skil.editingItem.where"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-form-row",[i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v(" \n            "),e.new_skil.editingItem.valid?i("b-button",{attrs:{disabled:e.ei_add_disable,variant:"success"},on:{click:e.nc_add_abil_to_skil}},[e._v("Добавить умение")]):e._e(),e._v("  \n            "),i("b-button",{attrs:{disabled:!e.is_deletable(e.new_skil.skilData[0],e.new_skil.editingItem,!1),variant:"danger"},on:{click:function(t){return e.delete_el(e.new_skil.skilData[0].children,e.new_skil.editingItem)}}},[e._v("Удалить компонент")]),e._v("\n             \n            ")],1)],1):e._e(),e._v(" "),"abil"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Уметь",value:"Уметь"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Что?"}},[i("b-input",{attrs:{required:"",placeholder:"Что?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При помощи чего?"}},[i("b-input",{attrs:{required:"",placeholder:"При помощи чего?"},model:{value:e.new_skil.editingItem.with,callback:function(t){e.$set(e.new_skil.editingItem,"with",t)},expression:"new_skil.editingItem.with"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При каких условиях?"}},[i("b-input",{attrs:{required:"",placeholder:"При каких условиях?"},model:{value:e.new_skil.editingItem.where,callback:function(t){e.$set(e.new_skil.editingItem,"where",t)},expression:"new_skil.editingItem.where"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v(" "),e.new_skil.editingItem.valid?i("b-button",{attrs:{disabled:e.ei_add_disable,variant:"warning"},on:{click:e.nc_add_know_to_abil}},[e._v("Добавить знание")]):e._e(),e._v("\n             \n            "),i("b-button",{attrs:{disabled:!e.is_deletable(e.new_skil.skilData[0],e.new_skil.editingItem,!1),variant:"danger"},on:{click:function(t){return e.delete_el(e.new_skil.skilData[0].children,e.new_skil.editingItem)}}},[e._v("Удалить компонент")])],1):e._e(),e._v(" "),"know"===e.new_skil.editingItem.type?i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[e.new_skil.editingItem.valid?e._e():i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры компонента")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Знать",value:"Знать"},model:{value:e.new_skil.editingItem.keyword,callback:function(t){e.$set(e.new_skil.editingItem,"keyword",t)},expression:"new_skil.editingItem.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Что?"}},[i("b-input",{attrs:{required:"",placeholder:"Что?"},model:{value:e.new_skil.editingItem.what,callback:function(t){e.$set(e.new_skil.editingItem,"what",t)},expression:"new_skil.editingItem.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название:"}},[i("p",[e._v(e._s(e.ei_fulltext))])])],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Сохранить")]),e._v("\n             \n            "),i("b-button",{attrs:{disabled:!e.is_deletable(e.new_skil.skilData[0],e.new_skil.editingItem,!1),variant:"danger"},on:{click:function(t){return e.delete_el(e.new_skil.skilData[0].children,e.new_skil.editingItem)}}},[e._v("Удалить компонент")])],1):e._e()],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[this.new_skil.show_errors?i("b-alert",{attrs:{variant:"danger",show:""}},[i("strong",[e._v("Обнаружены ошибки!")]),e._v(" "),e._l(this.new_skil.errors,(function(t,n){return i("ul",{key:n},[i("li",[e._v(e._s(t))])])}))],2):e._e()],1)])],2)}),[],!1,null,null,null).exports,b={name:"new-comp",metaInfo:{title:"Формирование компетенции"},props:{tree_data:Object},data:function(){return{new_comp:{keyword:"Способен",what:"",with:"",where:"",selected:[]},state:null}},computed:{comp_fulltext:function(){return this.combine_text(this.new_comp)}},methods:{combine_text:function(e){return e.keyword+" "+e.what+" "+e.with+" "+e.where},nc_onSubmit:function(e){var t=this;e.preventDefault(),0==this.new_comp.selected.length?this.state=!1:(this.state=null,this.new_comp.text=this.combine_text(this.new_comp),this.$emit("add_comp",this.new_comp),this.new_comp={keyword:"Способен",what:"",with:"",where:"",selected:[]},this.$nextTick((function(){t.$bvModal.hide("modal-addcomp")})))},nc_onReset:function(e){e.preventDefault(),alert(JSON.stringify(this.form))}}},m=Object(r.a)(b,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-addcomp",modifiers:{"modal-addcomp":!0}}],attrs:{disabled:0==e.tree_data.children.length,variant:"primary"}},[e._v("Сформировать компетенцию")]),e._v(" "),i("b-modal",{attrs:{id:"modal-addcomp",size:"xl",title:"Формирование новой компетенции"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[i("span")]},proxy:!0}])},[i("b-form",{on:{submit:e.nc_onSubmit,reset:e.nc_onReset}},[i("b-alert",{attrs:{show:""}},[e._v("Заполните параметры названия и выберите компоненты, которые войдут в компетенцию ")]),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Ключевое слово"}},[i("b-form-input",{attrs:{disabled:"",required:"",placeholder:"Владеть",value:"Владеть"},model:{value:e.new_comp.keyword,callback:function(t){e.$set(e.new_comp,"keyword",t)},expression:"new_comp.keyword"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"На что?"}},[i("b-input",{attrs:{required:"",placeholder:"На что?"},model:{value:e.new_comp.what,callback:function(t){e.$set(e.new_comp,"what",t)},expression:"new_comp.what"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При помощи чего?"}},[i("b-input",{attrs:{required:"",placeholder:"При помощи чего?"},model:{value:e.new_comp.with,callback:function(t){e.$set(e.new_comp,"with",t)},expression:"new_comp.with"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"При каких условиях?"}},[i("b-input",{attrs:{required:"",placeholder:"При каких условиях?"},model:{value:e.new_comp.where,callback:function(t){e.$set(e.new_comp,"where",t)},expression:"new_comp.where"}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{staticClass:"col",attrs:{"label-size":"lg","label-cols-lg":"2",label:"Итоговое название"}},[i("b-form-input",{attrs:{disabled:"",value:e.comp_fulltext}})],1)],1),e._v(" "),i("b-form-row",[i("b-form-group",{attrs:{"label-size":"lg",label:"Навыки/умения, которые войдут в компетенцию:"}},[i("b-form-checkbox-group",{attrs:{id:"checkbox-group",state:e.state,stacked:"",name:"selectedItems"},model:{value:e.new_comp.selected,callback:function(t){e.$set(e.new_comp,"selected",t)},expression:"new_comp.selected"}},e._l(e.tree_data.children,(function(t,n){return i("b-form-checkbox",{key:n,attrs:{value:t.id,switch:""}},[e._v(e._s(t.text))])})),1),e._v(" "),i("b-form-invalid-feedback",{attrs:{state:e.state}},[e._v("Пожалуйста, выберите один или несколько компонентов")])],1)],1),e._v(" "),i("b-form-row",[i("b-button",{attrs:{type:"submit",block:"",variant:"primary"}},[e._v("Сформировать")]),e._v(" \n        ")],1)],1)],1)],1)}),[],!1,null,null,null).exports,u={name:"dpp_stage_work",metaInfo:{title:"Разработка ДПП"},components:{VJstree:l.a,OrganizationChart:a.a,NewSkill:d,NewAbility:_,EditItem:w,NewComp:m},data:function(){return{stage:{},isBusy:!0,editingItem:{},editingNode:null,show_edit_window:!1,treeData:[{text:"Новая компетенция",id:"nc",opened:!0,type:"folder",color:"btn-outline-dark",children:[]}],attachedTreeData:[{text:"Программа ДПП",id:"pr",opened:!0,type:"folder",color:"btn-outline-dark",children:[]}],data_to_edit:{}}},computed:{header:function(){return"Разработка ДПП / "+this.stage.dpp_name+" / "+this.stage.type_name}},methods:{itemClick:function(e){console.log(e.model.text+" clicked !"),this.editingNode=e,this.editingItem=e.model,this.treeData=this.treeData.slice(0)},form_check:function(e){},add_skil:function(e){var t=this;this.treeData[0].children.push(e),axios.post("/dpps/"+this.stage.dpp_id+"/"+this.stage.zun_version_id+"/add_skill",{skill:e}).then((function(){return t.get_zun_versions_data()}))},add_abil:function(e){var t=this;this.treeData[0].children.push(e),axios.post("/dpps/"+this.stage.dpp_id+"/"+this.stage.zun_version_id+"/add_ability",{ability:e}).then((function(){return t.get_zun_versions_data()}))},add_comp:function(e){var t=this;axios.post("/dpps/"+this.stage.dpp_id+"/"+this.stage.zun_version_id+"/add_competence",{competence:e}).then((function(e){return t.get_zun_versions_data()}))},get_zun_versions_data:function(){var e=this;axios.get("/dpps/"+this.$route.params.dpp+"/get_zun_version_data/"+this.stage.zun_version_id+"/unattached").then((function(t){return e.treeData[0].children=t.data})),this.$nextTick((function(){var t=e;axios.get("/dpps/"+e.$route.params.dpp+"/get_zun_version_data/"+e.stage.zun_version_id+"/attached").then((function(e){t.attachedTreeData[0].children=e.data}))}))},delete_el_from_tree:function(e){var t=this;this.$bvModal.msgBoxConfirm("Удалить компонент «"+e.text+"»?").then((function(i){if(!0===i){if(void 0!==t.editingItem.id){axios.post("/zuns/"+e.type+"/delete",{id:e.id});var n=t.editingNode.parentItem.indexOf(t.editingItem);t.editingNode.parentItem.splice(n,1)}console.log(e)}})).catch((function(e){console.log(e)}))},edit_item:function(e){var t=this;return this.editingItem=e,this.data_to_edit={text:"",show_edit:!1,show_errors:!1,editingItem:{},editingNode:null,skilData:[e],errors:[]},this.show_edit_window=!0,this.$nextTick((function(){t.$bvModal.show("modal-edititem")})),e},update_item:function(e){var t=this;console.log(e),axios.post("/dpps/"+this.stage.dpp_id+"/"+this.stage.zun_version_id+"/update_elem",{item:e}).then((function(e){return t.get_zun_versions_data()})).finally((function(){return t.$bvModal.hide("modal-edititem")}))},go_forward:function(){var e=this;axios.post("/dpps/"+this.$route.params.dpp+"/"+this.stage.id+"/go_next").then((function(){return e.$router.push("/my_dpps/"+e.$route.params.dpp+"/overview/1")}))}},mounted:function(){var e=this;axios.get("/dpps/"+this.$route.params.dpp+"/get_stage_data/"+this.$route.params.stage).then((function(t){return e.stage=t.data})).finally((function(){return e.get_zun_versions_data()}))}},k=(i("FpiS"),Object(r.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("Назад")]),e._v(" "),i("b-card",{attrs:{title:e.header}},[i("b-card",{attrs:{"no-body":""}},[i("b-tabs",{attrs:{card:"","nav-wrapper-class":"bg-light"}},[i("b-tab",{attrs:{title:"Создание новой компетенции",active:""}},[i("b-alert",{attrs:{show:"",variant:"info"}},[i("h5",[e._v("Порядок действий:")]),e._v(" "),i("ol",[i("li",[e._v("Добавьте навыки, умения и знания, которыми должны обладать слушатели")]),e._v(" "),i("li",[e._v("Сформируйте компетенцию")])])]),e._v(" "),i("hr",{staticClass:"container-m-nx border-light my-4"}),e._v(" "),i("new-skill",{on:{add_skil:e.add_skil}}),e._v(" "),i("new-ability",{on:{add_abil:e.add_abil}}),e._v(" "),e.show_edit_window?i("edit-item",{attrs:{new_skil:e.data_to_edit},on:{update_item:e.update_item}}):e._e(),e._v(" "),i("new-comp",{attrs:{tree_data:e.treeData[0]},on:{add_comp:e.add_comp}}),e._v(" "),i("hr",{staticClass:"container-m-nx border-light my-4"}),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("h4",[e._v("Диаграмма связей компетенции")]),e._v(" "),i("organization-chart",{attrs:{datasource:e.treeData[0],direction:"l2r"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.nodeData;return[i("span",{class:"btn btn-block "+n.color},[e._v(e._s(n.text))])]}}])})],1)]),e._v(" "),i("hr",{staticClass:"container-m-nx border-light my-4"}),e._v(" "),i("h4",[e._v("Редактирование компонентов")]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("v-jstree",{class:{"tree-rtl":e.isRTL},attrs:{data:e.treeData,multiple:"","allow-batch":"","whole-row":""},on:{"item-click":e.itemClick},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"inherit",width:"100px"},on:{click:function(t){return t.ctrlKey?e.customItemClickWithCtrl(t):null}}},[t.model.loading?e._e():i("i",{class:t.vm.themeIconClasses,attrs:{role:"presentation"}}),e._v(" "),"folder"!=t.model.type&&1==t.model.is_main?i("span",{staticClass:"btn btn-outline-danger btn-xs",on:{click:function(i){return e.delete_el_from_tree(t.model,i)}}},[i("i",{staticClass:"ion ion-md-close"})]):e._e(),e._v(" "),"folder"!=t.model.type&&1==t.model.is_main?i("span",{staticClass:"btn btn-outline-info btn-xs",on:{click:function(i){return e.edit_item(t.model)}}},[i("i",{staticClass:"ion ion-md-create"})]):e._e(),e._v("   "),i("span",{domProps:{innerHTML:e._s(t.model.text)}}),e._v("   \n              ")])]}}])})],1),e._v(" "),i("div",{staticClass:"col-md-6"},[e._v("\n         \n      ")])])],1),e._v(" "),i("b-tab",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n                Компетенции ДПП "),i("b-badge",{attrs:{variant:"primary"}},[e._v(e._s(e.attachedTreeData[0].children.length))])]},proxy:!0}])},[e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("v-jstree",{class:{"tree-rtl":e.isRTL},attrs:{data:e.attachedTreeData,multiple:"","allow-batch":"","whole-row":""},on:{"item-click":e.itemClick},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"inherit",width:"100px"},on:{click:function(t){return t.ctrlKey?e.customItemClickWithCtrl(t):null}}},[t.model.loading?e._e():i("i",{class:t.vm.themeIconClasses,attrs:{role:"presentation"}}),e._v(" "),"folder"!=t.model.type&&1==t.model.is_main?i("span",{staticClass:"btn btn-outline-danger btn-xs",on:{click:function(i){return e.delete_el_from_tree(t.model,i)}}},[i("i",{staticClass:"ion ion-md-close"})]):e._e(),e._v("   "),"folder"!=t.model.type&&1==t.model.is_main?i("span",{staticClass:"btn btn-outline-info btn-xs",on:{click:function(i){return e.edit_item(t.model)}}},[i("i",{staticClass:"ion ion-md-create"})]):e._e(),e._v("   "),i("span",{domProps:{innerHTML:e._s(t.model.text)}}),e._v("    \n                        ")])]}}])})],1)])])],1)],1)],1)],1)}),[],!1,null,null,null));t.default=k.exports}}]);