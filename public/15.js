(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"3hb+":function(t,e,n){"use strict";n.r(e);var s={name:"create-subject",metaInfo:{title:"Добавить предмет оценки"},props:{zuns:Array},data:function(){return{new_subject:{},task_subject_types:{}}},computed:{competences:function(){return this.zuns.filter((function(t){return"Компетенция"==t.type}))},skills:function(){return this.zuns.filter((function(t){return"Навык"==t.type}))},abilities:function(){var t=this;return null==this.new_subject.skills?this.zuns.filter((function(t){return"Умение"==t.type})):this.zuns.filter((function(e){return"Умение"==e.type&&e.pid==t.new_subject.skills}))}},methods:{add_subject:function(t){t.preventDefault(),this.$emit("add_subject",this.new_subject)}},mounted:function(){var t=this;axios.post("/dpps/get_task_subject_types").then((function(e){return t.task_subject_types=e.data}))}},i=n("KHd+"),o=Object(i.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{id:"modal-2","ok-title":"Сохранить",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","cancel-title":"Закрыть",title:"Добавить предмет оценки"},on:{ok:t.add_subject}},[n("b-form-group",{attrs:{label:"Выберите, что будет оценивать данное задание"}},[n("b-form-select",{attrs:{options:t.task_subject_types,"value-field":"id","text-field":"name"},model:{value:t.new_subject.type_id,callback:function(e){t.$set(t.new_subject,"type_id",e)},expression:"new_subject.type_id"}})],1),t._v(" "),2==t.new_subject.type_id?n("div",[n("b-form-group",{attrs:{label:"Выберите навык, умения которого будут оцениваться"}},[n("b-form-select",{attrs:{options:t.skills,"value-field":"id","text-field":"name"},model:{value:t.new_subject.skills,callback:function(e){t.$set(t.new_subject,"skills",e)},expression:"new_subject.skills"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Выберите умения, которые будут оцениваться"}},[n("b-form-checkbox-group",{attrs:{stacked:"",options:t.abilities,"value-field":"id","text-field":"name",name:"abilities"},model:{value:t.new_subject.abilities,callback:function(e){t.$set(t.new_subject,"abilities",e)},expression:"new_subject.abilities"}})],1)],1):t._e(),t._v(" "),t.new_subject.type_id>2?n("div",[n("b-form-group",{attrs:{label:"Выберите навык(-и), которые будут оцениваться"}},[n("b-form-select",{attrs:{options:t.skills,"value-field":"id","text-field":"name"},model:{value:t.new_subject.skills,callback:function(e){t.$set(t.new_subject,"skills",e)},expression:"new_subject.skills"}})],1)],1):t._e()],1)}),[],!1,null,null,null).exports,a={name:"create-object",metaInfo:{title:"Добавить объект оценки"},props:{subjects:Array},data:function(){return{new_object:{}}},methods:{add_object:function(t){t.preventDefault(),this.$emit("add_object",this.new_object)}},mounted:function(){}},r=Object(i.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{id:"modal-3","ok-title":"Сохранить",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","cancel-title":"Закрыть",title:"Добавить объект оценки"},on:{ok:t.add_object}},[n("b-form-group",{attrs:{"label-size":"lg",label:"Выберите предмет оценки"}},[n("b-form-select",{attrs:{options:t.subjects,"value-field":"id","text-field":"name"},model:{value:t.new_object.subject_id,callback:function(e){t.$set(t.new_object,"subject_id",e)},expression:"new_object.subject_id"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Описание объекта оценки"}},[n("b-form-textarea",{attrs:{rows:"5"},model:{value:t.new_object.name,callback:function(e){t.$set(t.new_object,"name",e)},expression:"new_object.name"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Модельный ответ объекта оценки"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_object.model_answer,callback:function(e){t.$set(t.new_object,"model_answer",e)},expression:"new_object.model_answer"}})],1)],1)}),[],!1,null,null,null).exports,l={name:"edit-object",metaInfo:{title:"Редактировать объект оценки"},props:{subjects:Array,object_id:Number},data:function(){return{new_object:{name:"",model_answer:"",subject_id:""}}},methods:{update_object:function(t){t.preventDefault(),this.$emit("update_object",this.new_object)}},mounted:function(){var t=this;axios.post("/dpps/tasks/get_task_object",{object_id:this.object_id}).then((function(e){return t.new_object=e.data}))}},c=Object(i.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{id:"modal-4","ok-title":"Сохранить",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","cancel-title":"Закрыть",title:"Редактировать объект оценки"},on:{ok:t.update_object}},[n("b-form-group",{attrs:{"label-size":"lg",label:"Выберите предмет оценки"}},[n("b-form-select",{attrs:{options:t.subjects,"value-field":"id","text-field":"name"},model:{value:t.new_object.subject_id,callback:function(e){t.$set(t.new_object,"subject_id",e)},expression:"new_object.subject_id"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Описание объекта оценки"}},[n("b-form-textarea",{attrs:{rows:"5"},model:{value:t.new_object.name,callback:function(e){t.$set(t.new_object,"name",e)},expression:"new_object.name"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Модельный ответ объекта оценки"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_object.model_answer,callback:function(e){t.$set(t.new_object,"model_answer",e)},expression:"new_object.model_answer"}})],1)],1)}),[],!1,null,null,null).exports,_={name:"create-question",metaInfo:{title:"Добавить типовой вопрос для собеседования по материалам портфолио"},props:{},data:function(){return{new_object:{}}},methods:{add_question:function(t){t.preventDefault(),this.$emit("add_question",this.new_object)}},mounted:function(){}},d=Object(i.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{id:"modal-5","ok-title":"Сохранить",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","cancel-title":"Закрыть",title:"Добавить типовой вопрос для собеседования по материалам портфолио"},on:{ok:t.add_question}},[n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Текст вопроса"}},[n("b-form-textarea",{attrs:{rows:"5"},model:{value:t.new_object.name,callback:function(e){t.$set(t.new_object,"name",e)},expression:"new_object.name"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Модельный ответ"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_object.model_answer,callback:function(e){t.$set(t.new_object,"model_answer",e)},expression:"new_object.model_answer"}})],1)],1)}),[],!1,null,null,null).exports,u={name:"edit-question",metaInfo:{title:"Редактировать типовой вопрос для собеседования по материалам портфолио"},props:{question_id:Number},data:function(){return{new_object:{name:"",model_answer:"",subject_id:""}}},methods:{update_question:function(t){t.preventDefault(),this.$emit("update_question",this.new_object)}},mounted:function(){var t=this;axios.post("/dpps/tasks/get_task_question",{question_id:this.question_id}).then((function(e){return t.new_object=e.data}))}},p=Object(i.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{id:"modal-6","ok-title":"Сохранить",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","cancel-title":"Закрыть",title:"Редактировать типовой вопрос для собеседования по материалам портфолио"},on:{ok:t.update_question}},[n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Текст вопроса"}},[n("b-form-textarea",{attrs:{rows:"5"},model:{value:t.new_object.name,callback:function(e){t.$set(t.new_object,"name",e)},expression:"new_object.name"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Модельный ответ"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_object.model_answer,callback:function(e){t.$set(t.new_object,"model_answer",e)},expression:"new_object.model_answer"}})],1)],1)}),[],!1,null,null,null).exports,f=n("xY7A"),m={name:"new-mto",props:{types:Array},data:function(){return{parent_type_selected:"",child_type_selected:"",new_mto:{name:"",measure:""},errors:[]}},computed:{parent_types:function(){return this.types.filter((function(t){return null==t.parent_id}))},children_types:function(){var t=this,e=this.types.find((function(e){return e.id==t.parent_type_selected}));return this.types.filter((function(t){return t.parent_id==e.id}))},type_has_children:function(){var t=this,e=this.types.find((function(e){return e.id==t.parent_type_selected}));if(e&&this.types.filter((function(t){return t.parent_id==e.id})).length>0)return!0;return!1},selected_type:function(){var t=this;if(""!=this.parent_type_selected){var e=this.types.find((function(e){return e.id==t.parent_type_selected}));if(0==this.types.filter((function(t){return t.parent_id==e.id})).length)return this.parent_type_selected;if(""!=this.child_type_selected)return this.child_type_selected}return null}},methods:{handleOk:function(t){t.preventDefault(),this.errors=[],null==this.selected_type?this.errors.push("Выберите/уточните тип МТО"):(""==this.new_mto.name&&this.errors.push("Введите название МТО"),""==this.new_mto.measure&&this.errors.push("Введите единицу измерения МТО")),0==this.errors.length&&this.$emit("add_mto",{type_id:this.selected_type,mto_data:this.new_mto})}}},b=Object(i.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-newmto",modifiers:{"modal-newmto":!0}}],attrs:{variant:"primary"}},[t._v("Добавить МТО")]),t._v(" "),n("b-modal",{attrs:{size:"xl",id:"modal-newmto",title:"Добавить МТО","ok-title":"Добавить","cancel-title":"Закрыть"},on:{ok:t.handleOk}},[n("div",[n("b-form-group",{attrs:{"label-size":"lg",label:"Выберите тип МТО"}},[n("b-form-select",{attrs:{options:t.parent_types,"value-field":"id","text-field":"name"},on:{change:function(e){t.child_type_selected=""}},model:{value:t.parent_type_selected,callback:function(e){t.parent_type_selected=e},expression:"parent_type_selected"}})],1),t._v(" "),t.type_has_children?n("b-form-group",{attrs:{"label-size":"lg",label:"Уточните тип МТО"}},[n("b-form-select",{attrs:{options:t.children_types,"value-field":"id","text-field":"name"},model:{value:t.child_type_selected,callback:function(e){t.child_type_selected=e},expression:"child_type_selected"}})],1):t._e(),t._v(" "),null!=t.selected_type?n("div",[n("b-form-group",{attrs:{"label-size":"lg",label:"Название МТО"}},[n("b-form-input",{model:{value:t.new_mto.name,callback:function(e){t.$set(t.new_mto,"name",e)},expression:"new_mto.name"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",label:"Единица измерения МТО"}},[n("b-form-input",{model:{value:t.new_mto.measure,callback:function(e){t.$set(t.new_mto,"measure",e)},expression:"new_mto.measure"}})],1)],1):t._e(),t._v(" "),t.errors.length>0?n("b-alert",{attrs:{show:"",variant:"danger"}},[t._v("Обнаружены ошибки:\n            "),n("ul",t._l(t.errors,(function(e,s){return n("li",{key:"e"+s},[t._v(t._s(e))])})),0)]):t._e()],1)])],1)}),[],!1,null,null,null).exports,h={name:"edit-mto",props:{types:Array,mto_id:Number},data:function(){return{parent_type_selected:"",child_type_selected:"",new_mto:{name:"",measure:""},errors:[]}},computed:{parent_types:function(){return this.types.filter((function(t){return null==t.parent_id}))},children_types:function(){var t=this,e=this.types.find((function(e){return e.id==t.parent_type_selected}));return this.types.filter((function(t){return t.parent_id==e.id}))},type_has_children:function(){var t=this,e=this.types.find((function(e){return e.id==t.parent_type_selected}));if(e&&this.types.filter((function(t){return t.parent_id==e.id})).length>0)return!0;return!1},selected_type:function(){var t=this;if(""!=this.parent_type_selected){var e=this.types.find((function(e){return e.id==t.parent_type_selected}));if(0==this.types.filter((function(t){return t.parent_id==e.id})).length)return this.parent_type_selected;if(""!=this.child_type_selected)return this.child_type_selected}return null}},methods:{handleOk:function(t){t.preventDefault(),this.errors=[],null==this.selected_type?this.errors.push("Выберите/уточните тип МТО"):(""==this.new_mto.name&&this.errors.push("Введите название МТО"),""==this.new_mto.measure&&this.errors.push("Введите единицу измерения МТО")),0==this.errors.length&&this.$emit("update_mto",{type_id:this.selected_type,mto_data:this.new_mto})}},mounted:function(){var t=this;self=this,axios.get("/mtos/get_mto/"+this.mto_id).then((function(e){return t.new_mto=e.data})).finally((function(){var t=self.types.find((function(t){return t.id==self.new_mto.type_id}));if(null==t.parent_id)self.parent_type_selected=t.id;else{var e=self.types.find((function(e){return e.id==t.id})),n=self.types.find((function(t){return t.id==e.parent_id}));self.child_type_selected=t.id,self.parent_type_selected=n.id}}))}},v=Object(i.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-modal",{attrs:{size:"xl",id:"modal-editmto",title:"Редактирование МТО","ok-title":"Сохранить","cancel-title":"Закрыть"},on:{ok:t.handleOk}},[n("div",[n("b-form-group",{attrs:{"label-size":"lg",label:"Выберите тип МТО"}},[n("b-form-select",{attrs:{options:t.parent_types,"value-field":"id","text-field":"name"},on:{change:function(e){t.child_type_selected=""}},model:{value:t.parent_type_selected,callback:function(e){t.parent_type_selected=e},expression:"parent_type_selected"}})],1),t._v(" "),t.type_has_children?n("b-form-group",{attrs:{"label-size":"lg",label:"Уточните тип МТО"}},[n("b-form-select",{attrs:{options:t.children_types,"value-field":"id","text-field":"name"},model:{value:t.child_type_selected,callback:function(e){t.child_type_selected=e},expression:"child_type_selected"}})],1):t._e(),t._v(" "),null!=t.selected_type?n("div",[n("b-form-group",{attrs:{"label-size":"lg",label:"Название МТО"}},[n("b-form-input",{model:{value:t.new_mto.name,callback:function(e){t.$set(t.new_mto,"name",e)},expression:"new_mto.name"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",label:"Единица измерения МТО"}},[n("b-form-input",{model:{value:t.new_mto.measure,callback:function(e){t.$set(t.new_mto,"measure",e)},expression:"new_mto.measure"}})],1)],1):t._e(),t._v(" "),t.errors.length>0?n("b-alert",{attrs:{show:"",variant:"danger"}},[t._v("Обнаружены ошибки:\n            "),n("ul",t._l(t.errors,(function(e,s){return n("li",{key:"e"+s},[t._v(t._s(e))])})),0)]):t._e()],1)])],1)}),[],!1,null,null,null).exports,k={name:"mtos",props:{dpp_id:String,mode:String},components:{NewMto:b,EditMto:v},data:function(){return{nm:"m",types:[],mtos:[],isBusy:!0,show_edit_window:!1,mto_to_edit:0}},computed:{parent_types:function(){return this.types.filter((function(t){return null==t.parent_id}))}},methods:{children_types:function(t){return this.types.filter((function(e){return e.parent_id==t}))},add_mto:function(t){self=this,axios.post("/mtos/add_mto",{mto_data:t.mto_data,type_id:t.type_id,dpp_id:this.dpp_id}).then((function(t){alert("МТО добавлено!"),self.nm=self.nm+1,self.mtos.push(t.data),self.$bvModal.hide("modal-newmto")}))},update_mto:function(t){self=this,axios.post("/mtos/update_mto",{type_id:t.type_id,mto_data:t.mto_data}).then((function(t){alert("МТО обновлено!"),self.mtos=self.mtos.filter((function(e){return e.id!=t.data.id})),self.mtos.push(t.data),self.$bvModal.hide("modal-editmto")}))},remove_mto:function(t){var e=this;this.$bvModal.msgBoxConfirm("Действительно хотите МТО «"+t.name+"»?").then((function(n){1==n&&axios.post("/mtos/remove_mto",{mto_id:t.id}).then((function(t){return e.mtos=e.mtos.filter((function(t){return t.id!=t.id}))}))}))},edit_mto:function(t){var e=this;this.mto_to_edit=t,this.show_edit_window=!0,this.$nextTick((function(){e.$bvModal.show("modal-editmto")}))}},mounted:function(){var t=this;self=this,axios.get("/mtos/mto_types").then((function(e){return t.types=e.data})),axios.get("/mtos/get_mtos/"+self.dpp_id).then((function(e){return t.mtos=e.data}))}},w=Object(i.a)(k,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-12"},[t.mode?t._e():n("div",[n("hr")]),t._v(" "),n("h4",[t._v("Материально-техническое обеспечение")]),t._v(" "),n("new-mto",{key:t.nm,attrs:{types:t.types},on:{add_mto:t.add_mto}}),t._v(" "),0!=t.mto_to_edit?n("edit-mto",{key:t.mto_to_edit,attrs:{mto_id:t.mto_to_edit,types:t.types},on:{update_mto:t.update_mto}}):t._e(),t._v(" "),n("hr"),t._v(" "),t._l(t.parent_types,(function(e,s){return n("div",{key:"t"+e.id},[n("h5",[t._v(t._s(s+1)+". "+t._s(e.name))]),t._v(" "),t._l(t.children_types(e.id),(function(e,i){return n("div",{key:"t"+e.id},[n("h6",[t._v(t._s(s+1)+"."+t._s(i+1)+". "+t._s(e.name))]),t._v(" "),n("b-list-group",t._l(t.mtos.filter((function(t){return t.type_id==e.id})),(function(e){return n("b-list-group-item",{key:"mto_"+e.id},[n("b-btn",{staticClass:"btn",attrs:{variant:"outline-primary icon-btn btn-xs"},on:{click:function(n){return n.preventDefault(),t.edit_mto(e.id)}}},[n("i",{staticClass:"ion ion-md-create"})]),t._v(" "),t.mode?t._e():n("b-btn",{staticClass:"btn",attrs:{variant:"outline-danger icon-btn btn-xs"},on:{click:function(n){return t.remove_mto(e)}}},[t._v("X")]),t._v("\n                 "+t._s(e.name)+", единица измерения: "+t._s(e.measure)+"\n              ")],1)})),1)],1)})),t._v(" "),n("b-list-group",t._l(t.mtos.filter((function(t){return t.type_id==e.id})),(function(e){return n("b-list-group-item",{key:"mto_"+e.id},[n("b-btn",{staticClass:"btn",attrs:{variant:"outline-primary icon-btn btn-xs"},on:{click:function(n){return n.preventDefault(),t.edit_mto(e.id)}}},[n("i",{staticClass:"ion ion-md-create"})]),t._v(" "),t.mode?t._e():n("b-btn",{staticClass:"btn",attrs:{variant:"outline-danger icon-btn btn-xs"},on:{click:function(n){return t.remove_mto(e)}}},[t._v("X")]),t._v("\n                 "+t._s(e.name)+", единица измерения: "+t._s(e.measure)+"\n              ")],1)})),1)],2)}))],2)])}),[],!1,null,null,null).exports,y={name:"task-mtos",props:{dpp_id:String},data:function(){return{mtos:[]}},methods:{add_mto_to_task:function(){}},mounted:function(){}},j=Object(i.a)(y,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.mto-choose",modifiers:{"mto-choose":!0}}],attrs:{variant:"primary"}},[this._v("Добавить МТО к заданию")]),this._v(" "),e("b-modal",{attrs:{id:"mto-choose","ok-title":"Сохранить",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","cancel-title":"Закрыть",title:"Добавить МТО к заданию"},on:{ok:this.add_mto_to_task}})],1)}),[],!1,null,null,null).exports,g={name:"edit-task",metaInfo:{title:"Создание и редактирование задания"},components:{CreateSubject:o,CreateObject:r,EditObject:c,CreateQuestion:d,EditQuestion:p,NsiChoose:f.a,Mtos:w,TaskMtos:j},data:function(){return{new_task:{subject_skills:[],specification:{description:"",place:"",source:"",time:"",portfolio_structure_req:"",portfolio_presentation_req:"",portfolio_procedure:""},subjects:[],objects:[],questions:[]},s_k:"sk",o_k:"ok",o_e_k:"oek",q_k:"qk",q_e_k:"qek",isBusy:!0,zuns:Array,task_subject_types:[],errors:[],stage:{},nsis:[]}},methods:{update_specification:function(t){var e=this;t.preventDefault(),axios.post("/dpps/tasks/update_specification",{task_id:this.new_task.id,specification:this.new_task.specification,nsis:this.new_task.nsis}).then((function(t){return e.new_task.specification=t.data})).finally((function(){return e.$bvModal.hide("modal-1")}))},create_subject:function(){var t=this;this.s_k+=1,this.$nextTick((function(){t.$bvModal.show("modal-2")}))},add_subject:function(t){var e=this;self=this,axios.post("/dpps/tasks/add_subject",{task_id:this.new_task.id,subject:t}).then((function(t){t.data.forEach((function(t){self.new_task.subjects.push(t)}))})).finally((function(){return e.$bvModal.hide("modal-2")}))},remove_subject:function(t){self=this,this.$bvModal.msgBoxConfirm("Действительно хотите удалить предмет оценки «"+t.name+"»?").then((function(e){!0===e&&axios.post("/dpps/tasks/remove_subject",{id:t.id}).then((function(e){self.new_task.objects=self.new_task.objects.filter((function(e){return e.subject_id!=t.id}))})).finally((function(e){self.new_task.subjects=self.new_task.subjects.filter((function(e){return e.id!=t.id}))}))}))},create_object:function(){var t=this;this.o_k+=1,this.$nextTick((function(){t.$bvModal.show("modal-3")}))},add_object:function(t){var e=this;self=this,axios.post("/dpps/tasks/add_object",{task_id:this.new_task.id,object:t}).then((function(t){self.new_task.objects.push(t.data)})).finally((function(){return e.$bvModal.hide("modal-3")}))},edit_object:function(t){var e=this;this.o_e_k=t,this.$nextTick((function(){e.$bvModal.show("modal-4")}))},update_object:function(t){var e=this;self=this,axios.post("/dpps/tasks/update_object",{object:t}).then((function(t){self.new_task.objects=self.new_task.objects.filter((function(e){return e.id!=t.data.id})),self.new_task.objects.push(t.data)})).finally((function(){return e.$bvModal.hide("modal-4")}))},remove_object:function(t){self=this,this.$bvModal.msgBoxConfirm("Действительно хотите удалить объект оценки «"+t.name+"»?").then((function(e){!0===e&&axios.post("/dpps/tasks/remove_object",{id:t.id}).then((function(e){self.new_task.objects=self.new_task.objects.filter((function(e){return e.id!=t.id}))}))}))},objects:function(t){return this.new_task.objects.filter((function(e){return e.subject_id==t}))},create_question:function(){var t=this;this.q_k+=1,this.$nextTick((function(){t.$bvModal.show("modal-5")}))},add_question:function(t){var e=this;self=this,axios.post("/dpps/tasks/add_task_question",{task_id:this.new_task.id,question:t}).then((function(t){self.new_task.questions.push(t.data)})).finally((function(){return e.$bvModal.hide("modal-5")}))},remove_question:function(t){self=this,this.$bvModal.msgBoxConfirm("Действительно хотите удалить вопрос «"+t.name+"»?").then((function(e){!0===e&&axios.post("/dpps/tasks/remove_task_question",{id:t.id}).then((function(e){self.new_task.questions=self.new_task.questions.filter((function(e){return e.id!=t.id}))}))}))},edit_question:function(t){var e=this;this.q_e_k=t,this.$nextTick((function(){e.$bvModal.show("modal-6")}))},update_question:function(t){var e=this;self=this,axios.post("/dpps/tasks/update_task_question",{question:t}).then((function(t){self.new_task.questions=self.new_task.questions.filter((function(e){return e.id!=t.data.id})),self.new_task.questions.push(t.data)})).finally((function(){return e.$bvModal.hide("modal-6")}))},change_nsi:function(t){this.new_task.nsis=t.nsi_data},add_nsi:function(t){this.nsis.push(t.nsi_data)},generate_id:function(){return"f".concat((~~(1e8*Math.random())).toString(16))},formatted:function(t){return null!=t?t.replace(/\r?\n/g,"<br/>"):"Не заполнено"},search_nsi:function(t){var e=this.nsis.find((function(e){return e.id==t}));if(e)return e.name}},mounted:function(){var t=this;self=this,axios.get("/dpps/"+this.$route.params.dpp+"/get_stage_data/"+this.$route.params.stage).then((function(e){return t.stage=e.data})).finally((function(t){axios.get("/nsis/"+self.stage.ish_version_id).then((function(t){return self.nsis=t.data})),axios.get("/dpps/"+self.$route.params.dpp+"/get_zuns_to_om/"+self.stage.zun_version_id).then((function(t){return self.zuns=t.data}))})),axios.get("/dpps/get_task_data/"+this.$route.params.task).then((function(t){console.log(t.data),self.new_task=t.data,self.isBusy=!1}))}},x=Object(i.a)(g,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isBusy?t._e():n("div",[n("b-button",{attrs:{variant:"primary"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("Назад")]),t._v(" "),n("h4",[t._v(t._s(t.new_task.name)+" ("+t._s(t.new_task.type_name)+")")]),t._v(" "),n("b-tabs",{attrs:{"content-class":"mt-3"}},[n("b-tab",{attrs:{title:"Описание",active:""}},[n("b-card",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],attrs:{variant:"primary"}},[t._v("Редактировать")]),t._v(" "),n("hr"),t._v(" "),n("b-modal",{attrs:{id:"modal-1","ok-title":"Сохранить",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","cancel-title":"Закрыть",title:"Редактирование описания"},on:{ok:t.update_specification}},[1==t.new_task.task_type_id?n("div",[n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Описание ситуации и постановка задачи"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_task.specification.description,callback:function(e){t.$set(t.new_task.specification,"description",e)},expression:"new_task.specification.description"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Условия выполнения задания"}}),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Место выполнения"}},[n("b-form-textarea",{model:{value:t.new_task.specification.place,callback:function(e){t.$set(t.new_task.specification,"place",e)},expression:"new_task.specification.place"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Источники информации для выполнения"}},[n("nsi-choose",{attrs:{mode:"work",selected:t.new_task.nsis,ish_version_id:t.stage.ish_version_id},on:{add_nsi:t.add_nsi,change_nsi:t.change_nsi}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Максимальное время выполнения (минут)"}},[n("b-form-input",{attrs:{type:"number"},model:{value:t.new_task.specification.time,callback:function(e){t.$set(t.new_task.specification,"time",e)},expression:"new_task.specification.time"}})],1)],1):t._e(),t._v(" "),2==t.new_task.task_type_id?n("div",[n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Описание ситуации и постановка задачи"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_task.specification.description,callback:function(e){t.$set(t.new_task.specification,"description",e)},expression:"new_task.specification.description"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Источники информации для выполнения"}},[n("nsi-choose",{attrs:{mode:"work",selected:t.new_task.nsis,ish_version_id:t.stage.ish_version_id},on:{add_nsi:t.add_nsi,change_nsi:t.change_nsi}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Требования к структуре и оформлению портфолио"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_task.specification.portfolio_structure_req,callback:function(e){t.$set(t.new_task.specification,"portfolio_structure_req",e)},expression:"new_task.specification.portfolio_structure_req"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Требования к оформлению презентации"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_task.specification.portfolio_presentation_req,callback:function(e){t.$set(t.new_task.specification,"portfolio_presentation_req",e)},expression:"new_task.specification.portfolio_presentation_req"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Порядок защиты портфолио"}},[n("b-form-textarea",{attrs:{rows:"10"},model:{value:t.new_task.specification.portfolio_procedure,callback:function(e){t.$set(t.new_task.specification,"portfolio_procedure",e)},expression:"new_task.specification.portfolio_procedure"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-size":"lg",description:"",label:"Максимальное время защиты (минут)"}},[n("b-form-input",{attrs:{type:"number"},model:{value:t.new_task.specification.time,callback:function(e){t.$set(t.new_task.specification,"time",e)},expression:"new_task.specification.time"}})],1)],1):t._e()]),t._v(" "),1==t.new_task.task_type_id?n("div",[n("h5",[t._v("Описание ситуации и постановка задачи")]),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.formatted(t.new_task.specification.description))}}),t._v(" "),n("h5",[t._v("Условия выполнения задания")]),t._v(" "),n("h5",[t._v("Место выполнения")]),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.formatted(t.new_task.specification.place))}}),t._v(" "),n("h5",[t._v("Источники информации для выполнения")]),t._v(" "),0==t.new_task.nsis.length?n("div",{staticClass:"mb-2"},[t._v("Не заполнено")]):t._e(),t._v(" "),n("ul",t._l(t.new_task.nsis,(function(e){return n("li",{key:"nsi"+e},[t._v(t._s(t.search_nsi(e)))])})),0),t._v(" "),n("h5",[t._v("Максимальное время выполнения (минут)")]),t._v(" "),null==t.new_task.specification.time?n("div",{staticClass:"mb-2"},[t._v("Не заполнено")]):t._e(),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.new_task.specification.time)}}),t._v(" "),n("h5")]):t._e(),t._v(" "),2==t.new_task.task_type_id?n("div",[n("h5",[t._v("Описание ситуации и постановка задачи")]),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.formatted(t.new_task.specification.description))}}),t._v(" "),n("h5",[t._v("Источники информации для выполнения")]),t._v(" "),0==t.new_task.nsis.length?n("div",{staticClass:"mb-2"},[t._v("Не заполнено")]):t._e(),t._v(" "),n("ul",t._l(t.new_task.nsis,(function(e){return n("li",{key:"nsi"+e},[t._v(t._s(t.search_nsi(e)))])})),0),t._v(" "),n("h5",[t._v("Требования к структуре и оформлению портфолио")]),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.formatted(t.new_task.specification.portfolio_structure_req))}}),t._v(" "),n("h5",[t._v("Требования к оформлению презентации")]),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.formatted(t.new_task.specification.portfolio_presentation_req))}}),t._v(" "),n("h5",[t._v("Порядок защиты портфолио")]),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.formatted(t.new_task.specification.portfolio_procedure))}}),t._v(" "),n("h5",[t._v("Максимальное время защиты (минут)")]),t._v(" "),null==t.new_task.specification.time?n("div",{staticClass:"mb-2"},[t._v("Не заполнено")]):t._e(),t._v(" "),n("div",{staticClass:"mb-2",domProps:{innerHTML:t._s(t.new_task.specification.time)}})]):t._e()],1)],1),t._v(" "),n("b-tab",{attrs:{title:"Критерии оценки"}},[n("b-card",[n("b-dropdown",{staticClass:"m-md-2",attrs:{id:"dropdown-2",variant:"primary",text:"Добавить"}},[n("b-dropdown-item",{on:{click:t.create_subject}},[t._v("Добавить предмет оценки")]),t._v(" "),n("b-dropdown-item",{on:{click:t.create_object}},[t._v("Добавить объект оценки")]),t._v(" "),2==t.new_task.task_type_id?n("b-dropdown-item",{on:{click:t.create_question}},[t._v("Добавить типовое вопрос для собеседования по материалам портфолио")]):t._e()],1),t._v(" "),n("hr"),t._v(" "),n("h4",[t._v("Предметы и объекты оценки")]),t._v(" "),n("table",{staticClass:"table table-bordered"},[n("thead",[n("tr",[n("th",{attrs:{width:"50%"}},[t._v("Предмет оценки")]),n("th",[t._v("Объекты оценки")])])]),t._v(" "),n("tbody",[0==t.new_task.subjects.length?n("tr",[n("td",{attrs:{colspan:"3"}},[n("em",[t._v("Пока не добавлено ни одного предмета оценки. ")])])]):t._e(),t._v(" "),t._l(t.new_task.subjects,(function(e,s){return n("tr",{key:s},[n("td",[n("span",[n("b-btn",{staticClass:"btn-sm",attrs:{variant:"outline-danger icon-btn"},on:{click:function(n){return n.preventDefault(),t.remove_subject(e)}}},[n("i",{staticClass:"ion ion-md-close"})]),t._v(" "+t._s(e.name)+" ")],1)]),t._v(" "),n("td",t._l(t.objects(e.id),(function(e){return n("div",{key:"o"+e.id},[n("span",[n("b-btn",{staticClass:"btn-sm",attrs:{variant:"outline-danger icon-btn"},on:{click:function(n){return n.preventDefault(),t.remove_object(e)}}},[n("i",{staticClass:"ion ion-md-close"})])],1),t._v(" "),n("span",[n("b-btn",{staticClass:"btn-sm",attrs:{variant:"outline-info icon-btn"},on:{click:function(n){return n.preventDefault(),t.edit_object(e.id)}}},[n("i",{staticClass:"ion ion-md-create"})])],1),t._v("\n                    "+t._s(e.name)+"\n                  ")])})),0)])}))],2)]),t._v(" "),n("h4",[t._v("Модельные ответы")]),t._v(" "),n("table",{staticClass:"table table-bordered"},[n("thead",[n("tr",[n("th",{attrs:{width:"50%"}},[t._v("Объект оценки")]),n("th",[t._v("Модельный ответ")])])]),t._v(" "),n("tbody",[0==t.new_task.objects.length?n("tr",[n("td",{attrs:{colspan:"2"}},[n("em",[t._v("Пока не добавлено ни одного объекта оценки. ")])])]):t._e(),t._v(" "),t._l(t.new_task.objects,(function(e){return n("tr",{key:"o_"+e.id},[n("td",{domProps:{innerHTML:t._s(t.formatted(e.name))}}),t._v(" "),n("td",{domProps:{innerHTML:t._s(t.formatted(e.model_answer))}})])}))],2)]),t._v(" "),2==t.new_task.task_type_id?n("div",[n("h4",[t._v("Типовые вопросы для собеседования по материалам портфолио")]),t._v(" "),n("table",{staticClass:"table table-bordered"},[n("thead",[n("tr",[n("th",{attrs:{width:"30%"}},[t._v("Вопрос")]),n("th",{attrs:{width:"30%"}},[t._v("Модельный ответ")]),n("th",[t._v("Действия")])])]),t._v(" "),n("tbody",[0==t.new_task.questions.length?n("tr",[n("td",{attrs:{colspan:"2"}},[n("em",[t._v("Пока не добавлено ни одного типового вопроса. ")])])]):t._e(),t._v(" "),t._l(t.new_task.questions,(function(e){return n("tr",{key:"q_"+e.id},[n("td",{domProps:{innerHTML:t._s(t.formatted(e.name))}}),t._v(" "),n("td",{domProps:{innerHTML:t._s(t.formatted(e.model_answer))}}),t._v(" "),n("td",[n("span",[n("b-btn",{staticClass:"btn-sm",attrs:{variant:"outline-danger icon-btn"},on:{click:function(n){return n.preventDefault(),t.remove_question(e)}}},[n("i",{staticClass:"ion ion-md-close"})])],1),t._v(" "),n("span",[n("b-btn",{staticClass:"btn-sm",attrs:{variant:"outline-info icon-btn"},on:{click:function(n){return n.preventDefault(),t.edit_question(e.id)}}},[n("i",{staticClass:"ion ion-md-create"})])],1)])])}))],2)])]):t._e(),t._v(" "),"sk"!=t.s_k?n("create-subject",{key:t.s_k,attrs:{zuns:t.zuns},on:{add_subject:t.add_subject}}):t._e(),t._v(" "),"ok"!=t.o_k?n("create-object",{key:t.o_k,attrs:{subjects:t.new_task.subjects},on:{add_object:t.add_object}}):t._e(),t._v(" "),"oek"!=t.o_e_k?n("edit-object",{key:t.o_e_k,attrs:{subjects:t.new_task.subjects,object_id:t.o_e_k},on:{update_object:t.update_object}}):t._e(),t._v(" "),"qk"!=t.q_k?n("create-question",{key:t.q_k,on:{add_question:t.add_question}}):t._e(),t._v(" "),"qek"!=t.q_e_k?n("edit-question",{key:t.q_e_k,attrs:{question_id:t.q_e_k},on:{update_question:t.update_question}}):t._e()],1)],1),t._v(" "),n("b-tab",{attrs:{title:"Материально-техническое обеспечение"}},[n("task-mtos",{attrs:{dpp_id:this.$route.params.dpp}}),t._v(" "),n("mtos",{attrs:{dpp_id:this.$route.params.dpp}})],1)],1)],1)}),[],!1,null,null,null);e.default=x.exports},xY7A:function(t,e,n){"use strict";var s=n("WfUU"),i=n("ouQC"),o={name:"nsi-choose",props:{ish_version_id:Number,selected:Array},components:{NewNsi:s.a,EditNsi:i.a},data:function(){return{nn:"n",types:[],nsis:[],isBusy:!0,show_edit_window:!1,nsi_to_edit:0}},computed:{npas:function(){return this.nsis.filter((function(t){return 1==t.type_id}))},ychs:function(){return this.nsis.filter((function(t){return 2==t.type_id}))},irs:function(){return this.nsis.filter((function(t){return 3==t.type_id}))},ebss:function(){return this.nsis.filter((function(t){return 4==t.type_id}))}},methods:{add_nsi:function(t){var e=this,n=this;axios.post("/nsis/add_nsi",{nsi_data:t.nsi_data,ish_version_id:this.ish_version_id}).then((function(t){alert("Источник добавлен!"),n.nn++,n.nsis.push(t.data),e.$emit("add_nsi",{nsi_data:t.data})}))},update_nsi:function(t){var e=this;axios.post("/nsis/update_nsi",{nsi_data:t.nsi_data}).then((function(n){alert("Источник обновлен!"),e.nsis=e.nsis.filter((function(e){return e.id!=t.nsi_data.id})),e.nsis.push(n.data),e.$bvModal.hide("modal-editnsi")}))},remove_nsi:function(t){var e=this;this.$bvModal.msgBoxConfirm("Действительно хотите источник?").then((function(n){1==n&&axios.post("/nsis/remove_nsi",{nsi_id:t}).then((function(t){return e.nsis=e.nsis.filter((function(e){return e.id!=t.data}))}))}))},edit_nsi:function(t){var e=this;this.nsi_to_edit=t,this.show_edit_window=!0,this.$nextTick((function(){e.$bvModal.show("modal-editnsi")}))},change_nsi:function(t){this.$emit("change_nsi",{nsi_data:this.selected})}},mounted:function(){var t=this;axios.get("/nsis/nsi_types").then((function(e){return t.types=e.data})),axios.get("/nsis/"+this.ish_version_id).then((function(e){return t.nsis=e.data}))}},a=n("KHd+"),r=Object(a.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-12"},[n("h5",[t._v("Выбрано источников ("+t._s(t.selected.length)+")")])])]),t._v(" "),t._l(t.types,(function(e){return n("div",{key:"t"+e.id,staticClass:"col-md-12"},[n("h5",[t._v(t._s(e.name)+" ("+t._s(t.nsis.filter((function(t){return t.type_id==e.id})).length)+")")]),t._v(" "),n("b-form-checkbox-group",{attrs:{options:t.nsis.filter((function(t){return t.type_id==e.id})),name:"nsis","value-field":"id","text-field":"name",stacked:""},on:{input:t.change_nsi},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),t._v(" "),n("br")],1)})),t._v(" "),n("new-nsi",{key:t.nn,attrs:{types:t.types},on:{add_nsi:t.add_nsi}}),t._v(" "),t.show_edit_window?n("edit-nsi",{key:t.nsi_to_edit,attrs:{nsi_id:t.nsi_to_edit,types:t.types},on:{update_nsi:t.update_nsi}}):t._e()],2)}),[],!1,null,null,null);e.a=r.exports}}]);